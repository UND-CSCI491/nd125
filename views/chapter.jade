extends master

mixin addChapter(i, o, k)
    li
        a(href="/chapters/#{k}")= (i+1)+'. '+o.title

block title
    !=title

block css
    link(href="/css/chapter.css", rel="stylesheet")
    
block navbar
    nav(class="navbar navbar-default navbar-fixed-top")
        div(class="container-fluid")
            div(class="navbar-header")
                button(type="button", class="navbar-toggle collapsed", data-toggle="collapse", data-target=".navbar-collapse")
                    span(class="icon-bar")
                    span(class="icon-bar")
                    span(class="icon-bar")
                a(class="navbar-brand", href="#") ND@125
            div(class="collapse navbar-collapse")
                ul(class="nav navbar-nav")
                    li(class="dropdown")
                        a(href="#", class="dropdown-toggle", data-toggle="dropdown", role="button", aria-expanded="false")
                            |Chapters 
                            span(class="caret")
                        ul(class="dropdown-menu", role="menu")
                            - var keys = Object.keys(data)
                            - for (var i = 0, n = keys.length; i < n; i++)
                                +addChapter(i, data[keys[i]], keys[i])
                    li
                        a(href="/map") Atlas
                ul(class="nav navbar-nav navbar-right")
                    - var prev, next, keys = Object.keys(data)
                    - for (var i = 0, n = keys.length; i < n; i++)
                        - if (keys[i] === chapter)
                            - prev = keys[i-1]
                            - next = keys[i+1]
                            - break
                    - if (prev)
                        li
                            a(href="/chapters/#{prev}") Previous Chapter
                    - if (next)
                        li
                            a(href="/chapters/#{next}") Next Chapter

block main
    div(class="main-content")
        h1(class="bold", style="margin-bottom: 50px;")!= title
        - for (var i = 0, n = data[chapter].sections.length; i < n; i++)
            - var cur = data[chapter].sections[i]
            div(class="section-div")
                h2(class="into-title")= cur.title
                div(class="intro-content")= cur.content 

block js
    script(src="/js/chapter.js")
